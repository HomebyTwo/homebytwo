{% extends "base.html" %}
{% load leaflet_tags geojson_tags humanize %}

{% block title %}Home by Two - {{ route.name }}{% endblock %}

{% block extralinks %}
    {% leaflet_js %}
    {% leaflet_css %}
{% endblock extralinks %}

{% block content %}
    <h1 class="mrgt mrgb0 text-center">{{ route.name}}</h1>
    <h2 class="mrgv0 text-center">{{ route.get_length.km|floatformat:1|intcomma }}km - {{ route.get_totalup.m|floatformat:0|intcomma }}m+ - {{ route.get_totaldown.m|floatformat:0|intcomma }}m-</h2>
    <div class="clearfix mrg">
        <div class="pull-left" >&lsaquo; <a href="{% url 'routes:routes' %}">Routes list</a></div>
        {% if request.user == route.user %}
            <a class="pull-right" href="{% url 'routes:edit' route.id %}">Edit</a>
        {% endif %}
    </div>
    {% include 'routes/includes/_image.html' %}
    {% include 'routes/includes/_course.html' %}

    {% if route.geom %}
        {% leaflet_map "main" callback="detail_map_init" %}
    {% endif %}

{% endblock content %}

{% if route.geom %}
    {% block extrajs %}
        <script type="text/javascript">
            function detail_map_init (map, options) {
                var geom = L.geoJson({{ route.geom|geojsonfeature|safe }});
                geom.addTo(map);
                map.fitBounds(geom.getBounds());
                map.scrollWheelZoom.disable();
            }
        </script>
    {% endblock extrajs %}
{% endif %}